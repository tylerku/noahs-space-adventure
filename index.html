<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Noah's Space Adventure</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/p5.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- ========== HUD UI ========== -->
    <div id="ui-layer">
        <button class="m3-menu-btn" onclick="returnToMenu()">Menu</button>
        <div class="top-hud">
            <div class="repair-label">ROCKET REPAIR PROGRESS</div>
            <div class="progress-container">
                <div id="repair-bar"></div>
            </div>
        </div>
        <div class="status-box">
            <div class="hannah-hp">Hannah & James HP: <span id="hp-val">100</span></div>
        </div>
        <div class="controls">
            <span class="key">WASD</span> Move | <span class="key">Click</span> Shoot | <span class="key">Space</span> Swing Sword
        </div>
    </div>

    <!-- ========== GAME OVER / WIN SCREENS ========== -->
    <div id="overlay">
        <h1 id="ov-title">VICTORY!</h1>
        <h2 id="ov-desc">You saved Hannah and James!</h2>
        <button id="restart-btn" onclick="resetGame()">Play Again</button>
    </div>

    <!-- ========== MAIN MENU ========== -->
    <div id="main-menu">
        <div class="menu-stars">
            <div class="menu-star" style="top: 10%; left: 15%; animation-delay: 0.3s;"></div>
            <div class="menu-star" style="top: 25%; left: 45%; animation-delay: 0.8s;"></div>
            <div class="menu-star" style="top: 15%; left: 75%; animation-delay: 0.1s;"></div>
            <div class="menu-star" style="top: 40%; left: 25%; animation-delay: 0.6s;"></div>
            <div class="menu-star" style="top: 35%; left: 85%; animation-delay: 0.4s;"></div>
            <div class="menu-star" style="top: 60%; left: 10%; animation-delay: 0.9s;"></div>
            <div class="menu-star" style="top: 55%; left: 60%; animation-delay: 0.2s;"></div>
            <div class="menu-star" style="top: 75%; left: 35%; animation-delay: 0.7s;"></div>
            <div class="menu-star" style="top: 80%; left: 80%; animation-delay: 0.5s;"></div>
        </div>

        <h1 class="game-title">NOAH'S SPACE ADVENTURE</h1>
        <p class="game-subtitle">Select a Mission</p>

        <div class="missions-container">
            <div class="mission-card" data-mission="1" onclick="startMission(1)">
                <div class="mission-card-planet">üè†</div>
                <div class="mission-card-number">1</div>
                <div class="mission-card-name">Belle Pond Avenue</div>
                <div class="mission-card-status">Build Your Rocket</div>
            </div>

            <div class="mission-card" data-mission="2" onclick="startMission(2)">
                <div class="mission-card-planet">üåô</div>
                <div class="mission-card-number">2</div>
                <div class="mission-card-name">Moon Base</div>
                <div class="mission-card-status">Survive the Journey</div>
            </div>

            <div class="mission-card" data-mission="3" onclick="startMission(3)">
                <div class="mission-card-planet">üî¥</div>
                <div class="mission-card-number">3</div>
                <div class="mission-card-name">Mars Defense</div>
                <div class="mission-card-status">Save Hannah & James</div>
            </div>
        </div>

        <div class="menu-rocket">üöÄ</div>
        <div class="menu-footer">Press a mission card to start</div>
    </div>

    <!-- ========== MISSION INTRO (Mission 3) ========== -->
    <div id="mission-intro">
        <div class="scan-line"></div>
        <div class="corner-decor tl"></div>
        <div class="corner-decor tr"></div>
        <div class="corner-decor bl"></div>
        <div class="corner-decor br"></div>
        <div class="mission-container">
            <div class="mission-label">MISSION</div>
            <div class="mission-number">3</div>
            <div class="mission-title">
                <span class="highlight">Hannah</span> and baby <span class="highlight">James</span>
                are stranded on Mars!<br>
                Protect them while <span class="highlight">Dad</span> repairs the rocket.
            </div>
        </div>
    </div>

    <!-- ========== CUTSCENE (Mission 3) ========== -->
    <div id="cutscene">
        <div class="cutscene-stars"></div>
        <div class="speech-bubble">
            <span class="noah-name">Noah:</span> "Don't worry Hannah, I'll protect you and James!"<br><br>
            <span class="mommy-name">Hannah:</span> "Be careful Noah! The aliens are coming!"
        </div>
        <div class="click-continue">Click anywhere to start</div>
    </div>

    <!-- ========== VICTORY CUTSCENE ========== -->
    <div id="victory-cutscene">
        <div class="victory-scene">
            <div class="victory-stars">
                <div class="star" style="top: 10%; left: 20%;"></div>
                <div class="star" style="top: 25%; left: 50%;"></div>
                <div class="star" style="top: 15%; left: 80%;"></div>
                <div class="star" style="top: 40%; left: 15%;"></div>
                <div class="star" style="top: 35%; left: 65%;"></div>
                <div class="star" style="top: 5%; left: 35%;"></div>
            </div>
            <div class="victory-ground"></div>

            <div class="victory-rocket">
                <div class="rocket-flame">
                    <div class="flame-outer"></div>
                    <div class="flame-inner"></div>
                    <div class="flame-core"></div>
                </div>
                <div class="rocket-body">
                    <div class="rocket-nose"></div>
                    <div class="rocket-window"></div>
                    <div class="rocket-stripe top"></div>
                    <div class="rocket-stripe bottom"></div>
                    <div class="rocket-fin left"></div>
                    <div class="rocket-fin right"></div>
                </div>
            </div>

            <div class="smoke-cloud" style="left: 45%; width: 40px; height: 30px; animation-delay: 0s;"></div>
            <div class="smoke-cloud" style="left: 52%; width: 50px; height: 35px; animation-delay: 0.2s;"></div>
            <div class="smoke-cloud" style="left: 48%; width: 35px; height: 25px; animation-delay: 0.4s;"></div>

            <div class="victory-family">
                <div class="victory-noah">
                    <div class="hero-badge">HERO!</div>
                    <div class="noah-hair"></div>
                    <div class="noah-head"></div>
                    <div class="noah-face">
                        <div class="noah-eye left"></div>
                        <div class="noah-eye right"></div>
                        <div class="noah-smile"></div>
                    </div>
                    <div class="noah-arm-raised left"><div class="noah-hand"></div></div>
                    <div class="noah-arm-raised right"><div class="noah-hand"></div></div>
                    <div class="noah-body"></div>
                    <div class="character-label noah-label">Noah</div>
                </div>

                <div class="victory-dad">
                    <div class="dad-hair"></div>
                    <div class="dad-head"></div>
                    <div class="dad-face">
                        <div class="dad-eye left"></div>
                        <div class="dad-eye right"></div>
                        <div class="dad-smile"></div>
                    </div>
                    <div class="dad-body"></div>
                    <div class="character-label dad-label">Dad</div>
                </div>

                <div class="victory-hannah-small">
                    <div class="hannah-container">
                        <div class="hannah-hair"></div>
                        <div class="hannah-hair-left"></div>
                        <div class="hannah-hair-right"></div>
                        <div class="hannah-head"></div>
                        <div class="hannah-face">
                            <div class="hannah-eye left"></div>
                            <div class="hannah-eye right"></div>
                            <div class="hannah-smile"></div>
                        </div>
                        <div class="hannah-body"></div>
                        <div class="hannah-arm left"></div>
                        <div class="hannah-arm right"></div>
                        <div class="james-bundle">
                            <div class="james-hair"></div>
                            <div class="james-head"></div>
                            <div class="james-face">
                                <div class="james-eye left"></div>
                                <div class="james-eye right"></div>
                                <div class="james-smile"></div>
                            </div>
                        </div>
                    </div>
                    <div class="character-label hannah-label" style="left: 20px;">Hannah & James</div>
                </div>
            </div>

            <div class="victory-bubble bubble-dad">"Great job, Noah!"</div>
            <div class="victory-bubble bubble-hannah">"Thank you, big brother!"</div>
            <div class="victory-bubble bubble-noah">"Let's go home!"</div>

            <div class="victory-title">MISSION COMPLETE!</div>
            <div class="victory-subtitle">The family is safe and heading home to Earth!</div>
        </div>

        <div style="margin-top: 40px; display: flex; gap: 20px; justify-content: center;">
            <button class="victory-btn" style="position: static; transform: none; opacity: 1;" onclick="returnToMenu()">Continue Adventure</button>
        </div>
    </div>

    <!-- ========== MISSION 1 INTRO ========== -->
    <div id="mission1-intro">
        <div class="scan-line" style="background: linear-gradient(90deg, transparent, #00ff00, transparent);"></div>
        <div class="corner-decor tl" style="border-color: #00ff00;"></div>
        <div class="corner-decor tr" style="border-color: #00ff00;"></div>
        <div class="corner-decor bl" style="border-color: #00ff00;"></div>
        <div class="corner-decor br" style="border-color: #00ff00;"></div>
        <div class="mission-container">
            <div class="mission-label" style="color: #00ff00; text-shadow: 0 0 10px #00ff00;">MISSION</div>
            <div class="mission-number" style="color: #00cc00; text-shadow: 0 0 20px #00cc00;">1</div>
            <div class="mission-title">
                <span class="highlight" style="color: #00ff00;">Build your rocket!</span><br>
                Earn money by helping neighbors on<br>
                <span class="highlight" style="color: #ffcc00;">Belle Pond Avenue</span>
            </div>
        </div>
    </div>

    <!-- ========== MISSION 1 CUTSCENE ========== -->
    <div id="mission1-cutscene">
        <div class="speech-bubble">
            <span class="noah-name">Noah:</span> "I want to raise money so i can earn enough money for my rocket!"
        </div>
        <div class="click-continue">Click anywhere to start</div>
    </div>

    <!-- ========== MISSION 1 HUD ========== -->
    <div id="mission1-hud">
        <div class="m1-top-bar">
            <button class="m1-menu-btn" onclick="returnToMenu()">‚ò∞ Menu</button>
            <div class="m1-money-box">üí∞ $<span id="m1-money">0</span></div>
            <div class="m1-rocket-progress">
                <div class="m1-rocket-title">üöÄ Rocket Parts</div>
                <div class="m1-parts-grid">
                    <div class="m1-part" id="part-engine" title="Engine">üî•</div>
                    <div class="m1-part" id="part-body" title="Body">üõ¢Ô∏è</div>
                    <div class="m1-part" id="part-nose" title="Nose Cone">üî∫</div>
                    <div class="m1-part" id="part-fins" title="Fins">üîß</div>
                    <div class="m1-part" id="part-seat" title="Seat">üí∫</div>
                </div>
            </div>
            <div class="m1-lemonade-stats">
                üçã Lemonade: $<span id="m1-lemonade-earnings">0</span> |
                Customers: <span id="m1-customers">0</span>
            </div>
        </div>
        <div class="m1-bottom-bar">
            <div class="m1-controls">
                <span class="key">WASD</span> Move | <span class="key">E</span> Interact
            </div>
        </div>
    </div>

    <!-- Mission 1 UI Elements -->
    <div id="m1-tooltip" class="m1-tooltip"></div>

    <div id="m1-conversation" class="m1-conversation-dialog">
        <div id="m1-conv-name" class="m1-conv-name"></div>
        <div id="m1-conv-text" class="m1-conv-text"></div>
        <div id="m1-conv-options" class="m1-conv-options"></div>
    </div>

    <div id="m1-prompt" class="m1-interaction-prompt">
        <div id="m1-prompt-title" class="m1-prompt-title"></div>
        <div id="m1-prompt-text"></div>
        <div id="m1-prompt-mood"></div>
        <div id="m1-prompt-buttons" class="m1-prompt-buttons"></div>
    </div>

    <div id="m1-notification" class="m1-notification"></div>

    <div id="m1-niam-dialog" class="m1-niam-dialog">
        <div class="m1-niam-title">Hey Noah! Wanna come play?</div>
        <div class="m1-niam-subtitle">- Niam</div>
        <div class="m1-niam-buttons">
            <button class="m1-niam-btn play" onclick="niamPlay()">Sure, let's play! (Lose $5)</button>
            <button class="m1-niam-btn decline" onclick="niamDecline()">Not right now, I'm saving for my rocket!</button>
        </div>
    </div>

    <div id="m1-mommy-dialog" class="m1-mommy-dialog">
        <div class="m1-mommy-title">Hi sweetie! Need more lemonade supplies?</div>
        <div class="m1-mommy-subtitle">- Mommy</div>
        <div class="m1-mommy-buttons">
            <button class="m1-mommy-btn buy" onclick="buyMaterials()">Yes please! ($10 for more supplies)</button>
            <button class="m1-mommy-btn decline" onclick="closeMommyDialog()">No thanks, Mommy!</button>
        </div>
    </div>

    <div id="m1-shop" class="m1-shop-panel">
        <div class="m1-shop-title">üöÄ Rocket Shop</div>
        <div id="m1-shop-items" class="m1-shop-items"></div>
        <button class="m1-shop-close" onclick="closeShop()">Close</button>
    </div>

    <!-- ========== MISSION 1 VICTORY ========== -->
    <div id="mission1-victory">
        <div class="victory-scene" style="background: linear-gradient(180deg, #1a3a1a 0%, #2a5a2a 50%, #3a7a3a 100%); border-color: #00ff00;">
            <div class="victory-title" style="color: #00ff00; text-shadow: 0 0 20px #00ff00;">ROCKET COMPLETE!</div>
            <div class="victory-subtitle" style="top: 90px;">Time to save Hannah and James on Mars!</div>

            <div style="position: absolute; bottom: 150px; left: 50%; transform: translateX(-50%); text-align: center;">
                <div style="font-size: 120px; animation: rocketBob 1s ease-in-out infinite;">üöÄ</div>
                <div style="color: #fff; font-size: 24px; margin-top: 20px;">All parts collected!</div>
            </div>

            <div style="position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%); display: flex; gap: 20px; justify-content: center;">
                <button class="victory-btn" style="position: static; transform: none; opacity: 1;" onclick="returnToMenu()">Continue Adventure</button>
            </div>
        </div>
    </div>

    <!-- ========== MISSION 2 INTRO ========== -->
    <div id="mission2-intro">
        <div class="scan-line" style="background: linear-gradient(90deg, transparent, #aaccff, transparent);"></div>
        <div class="corner-decor tl" style="border-color: #aaccff;"></div>
        <div class="corner-decor tr" style="border-color: #aaccff;"></div>
        <div class="corner-decor bl" style="border-color: #aaccff;"></div>
        <div class="corner-decor br" style="border-color: #aaccff;"></div>
        <div class="mission-container">
            <div class="mission-label" style="color: #aaccff; text-shadow: 0 0 10px #aaccff;">MISSION</div>
            <div class="mission-number" style="color: #88aaff; text-shadow: 0 0 20px #88aaff;">2</div>
            <div class="mission-title">
                <span class="highlight" style="color: #aaccff;">Journey to the Moon!</span><br>
                <span class="highlight" style="color: #ffcc00;">Dad</span> is flying, but asteroids are hitting the ship!<br>
                Keep the rocket together and comfort your siblings!
            </div>
        </div>
    </div>

    <!-- ========== MISSION 2 CUTSCENE ========== -->
    <div id="mission2-cutscene">
        <div class="cutscene-stars"></div>
        <div class="speech-bubble">
            <span class="noah-name">Dad:</span> "Hold on everyone! We're hitting some turbulence!"<br><br>
            <span class="mommy-name">Hannah:</span> "I'm scared! Noah, help!"<br><br>
            <span class="noah-name">Noah:</span> "Don't worry, I'll keep us safe!"
        </div>
        <div class="click-continue">Click anywhere to start</div>
    </div>

    <!-- ========== MISSION 2 HUD ========== -->
    <div id="mission2-hud">
        <div class="m2-top-bar">
            <button class="m2-menu-btn" onclick="returnToMenu()">Menu</button>
            <div class="m2-journey-box">
                <div class="m2-journey-label">Journey to Moon</div>
                <div class="m2-journey-progress">
                    <div id="m2-journey-bar"></div>
                </div>
            </div>
            <div class="m2-status-box">
                <div class="m2-stat">
                    <span class="m2-stat-label">Ship Health:</span>
                    <div class="m2-bar-container">
                        <div id="m2-ship-health" class="m2-bar ship"></div>
                    </div>
                </div>
                <div class="m2-stat">
                    <span class="m2-stat-label">Hannah:</span>
                    <div class="m2-bar-container">
                        <div id="m2-hannah-stress" class="m2-bar stress"></div>
                    </div>
                </div>
                <div class="m2-stat">
                    <span class="m2-stat-label">James:</span>
                    <div class="m2-bar-container">
                        <div id="m2-james-stress" class="m2-bar stress"></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="m2-bottom-bar">
            <div class="m2-controls">
                <span class="key">WASD</span> Move | <span class="key">Hold E</span> Repair / Comfort
            </div>
        </div>
    </div>

    <!-- Mission 2 Tooltip -->
    <div id="m2-tooltip" class="m2-tooltip"></div>

    <!-- ========== MISSION 2 VICTORY ========== -->
    <div id="mission2-victory">
        <div class="victory-scene" style="background: linear-gradient(180deg, #0a1a2a 0%, #1a3a5a 50%, #2a4a6a 100%); border-color: #aaccff;">
            <div class="victory-title" style="color: #aaccff; text-shadow: 0 0 20px #aaccff;">MOON LANDING!</div>
            <div class="victory-subtitle" style="top: 90px;">You kept everyone safe during the journey!</div>

            <div style="position: absolute; bottom: 150px; left: 50%; transform: translateX(-50%); text-align: center;">
                <div style="font-size: 100px;">üåô</div>
                <div style="font-size: 60px; margin-top: -20px;">üöÄ</div>
                <div style="color: #fff; font-size: 24px; margin-top: 20px;">Welcome to the Moon!</div>
            </div>

            <div style="margin-top: 40px; display: flex; gap: 20px; justify-content: center;">
                <button class="victory-btn" style="position: static; transform: none; opacity: 1;" onclick="returnToMenu()">Continue Adventure</button>
            </div>
        </div>
    </div>

    <!-- ========== LOAD MODULAR GAME ========== -->
    <script type="module" src="src/main.js"></script>
</body>
</html>
